<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mappel: Install</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mappel
   </div>
   <div id="projectbrief">Maximum a posteriori Point Emitter Localization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Install </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Currently building has only been tested on linux hosts.</p>
<p>Mappel has been tested with modern GCC-7.2.0 as well as earlier GCC's to 4.9.4 (which is still required for Matlab integration). In order to maintain compatibility with gcc-4.9.4 and still use modern C++14 features we use the <code>-std=c++1y</code> GCC standard when compiling.</p>
<h2>Dependencies</h2>
<p>Several standard numerical packages are required to build Mappel. Most distributions should have development versions of these packages which provide the include files and other necessary development files for the packages.</p>
<ul>
<li><a href="http://arma.sourceforge.net/">Armadillo</a></li>
<li><a href="http://www.boost.org/">Boost</a></li>
<li><a href="https://github.com/rabauke/trng4">TRNG</a></li>
<li>BLAS<ul>
<li>Requires support for 64-bit integers.</li>
<li><a href="http://www.netlib.org/blas/">Netlib BLAS Reference</a></li>
</ul>
</li>
<li>LAPACK<ul>
<li>Requires support for 64-bit integers.</li>
<li><a href="http://www.netlib.org/lapack/">Netlib LAPACK Reference</a></li>
</ul>
</li>
</ul>
<h3>Gentoo</h3>
<p>Add to your <code>package.keywords</code></p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sci-libs/lapack-reference int64</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sci-libs/blas-reference int64</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;emerge -av armadillo boost lapack-reference blas-reference</div></div><!-- fragment --><p>For TRNG there is not a gentoo ebuild in the tree, we provide one at the <a href="https://github.com/markjolah/OlahScienceGentooOverlay">OlahGentooScienceOverlay</a>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;layman -o  https://github.com/markjolah/OlahScienceGentooOverlay/blob/master/layman.xml -f -a olah-science</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;emerge -av trng</div></div><!-- fragment --><h3>External Projects</h3>
<p>Mappel also depends on several small Github projects which for now are maintained in separate repositories.</p>
<ul>
<li><a href="https://github.com/markjolah/BacktraceException">BacktraceException</a> - A library to provide debugging output on exception calls. Important for Matlab debugging.</li>
<li><a href="https://github.com/markjolah/ParallelRngManager">ParallelRngManager</a> - A simple manager for easily deploying a set of RNG parallelized over a set number of threads, using the TRNG parallel RNG library.</li>
<li><a href="https://github.com/markjolah/ParallelRngManager">PriorHessian</a> - The PriorHessian library allows fast computation of log-likelihood and derivatives for composite priors.</li>
</ul>
<p>If these libraries do not exist on the build system or at <code>CMAKE_INSTALL_PREFIX</code>, they are automatically downloaded, configured and installed as external dependencies during the CMake configure phase.</p>
<p>Normally the Github current versions of the external dependencies are used. To use the HEAD revision of a local git repository, the following Environment variables can be set:</p>
<ul>
<li><code>BacktraceExceptionURL</code> - Local directory or git URL for the BacktraceException library [optional] Default to use the HEAD version from Github</li>
<li><code>ParallelRngManagerURL</code> - Local directory or git URL for the ParallelRngManager library</li>
<li><code>PriorHessianURL</code> - Local directory or git URL for the PriorHessian library</li>
</ul>
<h2>Build process</h2>
<h3>Linux</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone https://github.com/markjolah/Mappel.git</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd Mappel</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;./build.sh</div></div><!-- fragment --><p> On successful build the Mappel libraries, binaries, includes, and CMake modules are all installed to the <code>_install</code> dir.</p>
<h2>Debugging</h2>
<p>CMake variable <code>CMAKE_BUILD_TYPE=Debug</code> will configure the debug build and all libraries and executables will have a <code>.debug</code> suffix.</p>
<p>A convenience script exists to only build the debug versions of the libraries in the local <code>_build</code> and <code>_install</code> directories</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./build.debug.sh</div></div><!-- fragment --><p> Tips:</p><ul>
<li>Try running <code>VERBOSE=1 make</code> inside the <code>_build/Debug</code> directory to debug the build/link command lines generated by CMAKE.</li>
</ul>
<h2>Python support</h2>
<p>Matlab support is enabled by setting the CMake option <code>-DOPT_PYTHON=1</code>. At the moment only python 3 is supported.</p>
<p>Several CMake variable can control for which python version modules are built.</p><ul>
<li><code>MAPPEL_PYTHON_VERSIONS</code> - List of python X.Y versions seperated by ";" to build modules for (e.g., "3.4;3.5;3.6")</li>
<li><code>MAPPEL_PYTHON_EXECUTABLE</code> - Name or full path to python executable on the system for which to build (e.g., python3).</li>
</ul>
<p>Mappel uses <a href="https://pybind11.readthedocs.io/en/stable/">pybind11</a> to compile modules for each Mappel Model class.</p>
<h3>Python development workflow</h3>
<p>The Mappel python package environment is created in the build tree at <code>build_dir/python</code>, as part of the CMake build process. There is a standard <a href="https://setuptools.readthedocs.io/en/latest/setuptools.html#">setuptools</a> <code>setup.py</code> that can be used to build binary distributions and also to install to the local system.</p>
<p>The CMake install process will automatically install the python .egg using <code>setup.py</code> under the <code>CMAKE_INSTALL_PREFIX</code> directory.</p>
<p>In order to be able to develop the code at the root <code>mappel/python/</code> git repository while running and testing the mappel package without having to <code>make install</code> on every small change to python code, we use the <a href="https://setuptools.readthedocs.io/en/latest/setuptools.html#development-mode">developer mode</a> install option provided by setuptoools. In fact, we have made it even easier to use, by making an alias <code>localdevelop</code></p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd _build/Debug/python</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ python setup.py localdevelop</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ python -m mappel</div></div><!-- fragment --><h2>Matlab support</h2>
<p>Matlab support is enabled by setting the CMake option <code>MATLAB=on</code>. This brings in an additional external dependency,</p><ul>
<li><a href="https://github.com/markjolah/MexIFace">MexIFace</a> - A cross-platform Matlab/C++ class-based interface wrapper for generating .mex files.</li>
</ul>
<p>The following environment variables control the Matlab build process</p><ul>
<li><code>MexIFaceURL</code>: Local directory or git URL for the MexIface library (Matlab Support). [optional] Default to use the <code>HEAD</code> version from Github</li>
<li><code>MATLAB_LIBS_ROOT</code>: [Optional] Local path to find Matlab core shared libraries to link against (overrides default search paths). Must contain subdirectory structure <code>($MATLAB_ARCH)//{bin,extern}</code>. <code>MATLAB_ARCH</code> is [glnxa64, maci64, win64].</li>
<li><code>MATLAB_ROOT_GLNXA64</code>: Necessary for Matlab. Location of the Matlab <code>glnxa64</code> version to link against.</li>
</ul>
<h2>Cross-building to Win64</h2>
<p>The following Environment variables control the Win64 cross-build environment necessary to compile win64 binaries</p><ul>
<li><code>MXE_ROOT</code> Local directory root of the MXE Win64 cross environment. Necessary For Win64 cross-compiling only.</li>
<li><code>MATLAB_ROOT_WIN64</code> Necessary for Matlab on Win64 cross build. Location of the Matlab <code>win64</code> version to link against.</li>
</ul>
<h2>Cross-building to OSX</h2>
<ul>
<li><code>OSXCROSS_ROOT</code>: Local directory root of the OSXCross OSX 64-bit cross environment. Necessary for OSX cross-compiling only.</li>
<li><code>MATLAB_ROOT_MACI64</code>: Necessary for Matlab on OSX cross build. Location of the Matlab <code>maci64</code> version to link against. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
