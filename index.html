<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mappel: MAPPEL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mappel
   </div>
   <div id="projectbrief">Maximum a posteriori Point Emitter Localization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MAPPEL </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Mappel is an object-oriented image processing library for high-performance <a href="https://en.wikipedia.org/wiki/Super-resolution_microscopy#Localization_microscopy">super-resolution localization</a> of Gaussian point emitters in <a href="https://en.wikipedia.org/wiki/Fluorescence_microscope#Sub-diffraction_techniques">fluorescence microscopy</a> applications.</p><ul>
<li>Mappel uses CMake and builds cross-platform for Linux and Windows 64-bit.</li>
<li>Mappel provides object-oriented interfaces for C++, Python, and Matlab.</li>
<li>Mappel uses OpenMP to parallelize operations over vectors of images or parameters</li>
<li>Mappel is free-as-in-beer and free-as-in-speech! ([GPL-v3](LICENSE))</li>
</ul>
<h2>Documentation</h2>
<p>The Mappel Doxygen documentation can be build with the <code>OPT_DOC</code> CMake option and is also available on online:</p><ul>
<li><a href="https://markjolah.github.io/Mappel/index.html">Mappel HTML Manual</a></li>
<li><a href="https://markjolah.github.io/Mappel/pdf/Mappel-0.0.3-reference.pdf">Mappel PDF Manual</a></li>
<li><a href="https://github.com/markjolah/Mappel">Mappel github repository</a></li>
</ul>
<h2>Background</h2>
<p>Point emitter localization is a process of precisely estimating the sub-pixel location of a single point source emitters (molecules/proteins) at effective resolutions 10-50 times smaller than the fundamental diffraction limit for optical microscopes. Operationally, this is the process of going from blurry, noisy, pixelated images to a sub-pixel estimate of true emitter position as well as the uncertainty in that estimate. Figure 1 shows the point emitter localization process with realistic physical values for a typical super-resolution fluorescence microscope configuration.</p>
<p><a href="https://raw.githubusercontent.com/markjolah/Mappel/master/doc/images/mappel_fitting_resolution.png" title="full size image"></a></p>
<p><b>Figure 1</b>: Effective fitting resolution in typical applications </p>
<h3>Applications</h3>
<ul>
<li>Stochastic super-resolution reconstruction with <a href="https://en.wikipedia.org/wiki/Photoactivated_localization_microscopy">PALM</a> and <a href="https://en.wikipedia.org/wiki/Super-resolution_microscopy#Direct_stochastical_optical_reconstruction_microscopy_(dSTORM)">dSTORM</a> florescence microscopy techniques.</li>
<li><a href="https://en.wikipedia.org/wiki/Single-particle_tracking">Single particle tracking (SPT)</a><ul>
<li>The <a href="https://markjolah.github.io/RPT"><em>Robust Particle Tracking</em> (RPT)</a> library uses Mappel for the localization phase of tracking.</li>
</ul>
</li>
<li><a href="https://iopscience.iop.org/article/10.1088/1367-2630/aa5f74">Nano-structure optical measurements</a> and alignment.</li>
<li>Accurate estimation of fluorophore emitter intensity over time.</li>
</ul>
<h3>Performance</h3>
<p>Emitter localization applications, especially SPT and super-resolution imaging, can require millions of emitter estimations per dataset. This demand is only increasing with the drive towards larger EMCCD and SCMOS sensors and longer experiments at higher frame-rates. Speed becomes even more crucial for these applications when batch processing dozens of large data files.</p>
<ul>
<li>Mappel runs all image oriented computations in parallel using OpenMP making full use the system hardware concurrency.</li>
<li>Mappel is fast. It can easily localize 10^4 emitters/sec/core on modern consumer hardware</li>
<li>Small and medium-sized datasets using Mappel can work well on laptops allowing interactive Matlab applications like <a href="https://markjolah.github.io/RPT">RPT</a> to be used from nearly any machine.</li>
</ul>
<h2>Installation</h2>
<p>Mappel uses the <a href="https://cmake.org/cmake/help/latest/">CMake</a> build system, and is designed to be cross-compiled from linux to other platforms, primarily Win64, although future OSX support is planned.</p>
<h2>Dependencies</h2>
<p>Several standard numerical packages are required to build Mappel. Most distributions should have development versions of these packages which provide the include files and other necessary development files for the packages.</p>
<ul>
<li><a href="http://arma.sourceforge.net/docs.html"><em>Armadillo</em></a> - A high-performance array library for C++.</li>
<li><a href="http://www.boost.org/">Boost</a></li>
<li>BLAS<ul>
<li>Requires support for 64-bit integers.</li>
<li><a href="http://www.netlib.org/blas/">Netlib BLAS Reference</a></li>
</ul>
</li>
<li>LAPACK<ul>
<li>Requires support for 64-bit integers.</li>
<li><a href="http://www.netlib.org/lapack/">Netlib LAPACK Reference</a></li>
</ul>
</li>
</ul>
<p>Note the <code>OPT_BLAS_INT64</code> CMake option controls whether Armadillo uses BLAS and LAPACK libraries that use 64-bit integer indexing. Matlab uses 64-bit by default, so linking Mappel to Matlab MEX libraries requires this option enabled. Many linux systems only provide 32-bit integer versions of BLAS and Lapack, and the option can be disabled if Matlab support is not a concern and 64-bit support is difficult to provide.</p>
<h3>External Projects</h3>
<p>These packages are specialized CMake projects. If they are not currently installed on the development machines we use the <a href="https://github.com/markjolah/UncommonCMakeModules/blob/master/AddExternalDependency.cmake">AddExternalDependency.cmake</a> which will automatically download, configure, build and install to the <code>CMAKE_INSTALL_PREFIX</code>, enabling their use through the normal CMake <code>find_package()</code> system.</p>
<ul>
<li><a href="https://markjolah.github.iom/BacktraceException">BacktraceException</a> - A library to provide debugging output on exception calls. Important for Matlab debugging.</li>
<li><a href="https://markjolah.github.io/ParallelRngManager">ParallelRngManager</a> - A simple manager for easily deploying a set of RNG parallelized over a set number of threads, using the TRNG parallel RNG library.</li>
<li><a href="https:///markjolah.github.io/ParallelRngManager">PriorHessian</a> - The PriorHessian library allows fast computation of log-likelihood and derivatives for composite priors.</li>
</ul>
<h1>Model classes</h1>
<p>Mappel provides model objects that correspond to different fitting-modes (psf-models). Mappel's core is a C++ library <code>libmappel.so</code> that uses OpenMP to automatically parallelize localizations over multiple images. Mappel also provides detailed object-oriented interfaces for Python and Matlab, using the same concept of a Model class to represent each class of psf fitting models.</p>
<h2>Computations available</h2>
<ul>
<li><code>llh</code> - log-likelihood (log of pdf)</li>
<li><code>rllh</code> - relative log-likelihood (log of pdf without constant terms)</li>
<li><code>grad</code> - derivative of log-likelihood (or equivalently of relative-llh)</li>
<li><code>grad2</code> - 2nd-derivative of log-likelihood</li>
<li><code>hessian</code> - hessian of log-likelihood</li>
</ul>
<h1>Design Notes</h1>
<h2>Static Polymorphism</h2>
<p>The Mappel library is designed using static polymorphism (templates), and as such avoids virtual functions for small-grained tasks, and instead uses templates, which allow many small functions to be inlined. This aggressive inlining by the compiler produces log-likelihood, gradient, and hessian functions that are nearly as fast as hand-coded functions.</p>
<h1>License</h1>
<h1>LICENSE</h1>
<ul>
<li>Copyright: 2013-2019</li>
<li>Author: Mark J. Olah</li>
<li>Email: (<a href="#" onclick="location.href='mai'+'lto:'+'mjo'+'@c'+'s.u'+'nm'; return false;">mjo@c<span style="display: none;">.nosp@m.</span>s.un<span style="display: none;">.nosp@m.</span>m</a> DOT edu)</li>
<li>LICENSE: GPL-v3 See <a href="https://github.com/markjolah/MexIFace/blob/master/LICENSE">LICENSE</a> file. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
