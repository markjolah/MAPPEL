\hypertarget{openmp__methods_8h}{}\subsection{openmp\+\_\+methods.\+h File Reference}
\label{openmp__methods_8h}\index{openmp\+\_\+methods.\+h@{openmp\+\_\+methods.\+h}}


Namespaces for Open\+MP parallelized versions of the mappel\+::model namespace functions (external methods)  


{\ttfamily \#include $<$omp.\+h$>$}\\*
{\ttfamily \#include \char`\"{}Mappel/\+O\+M\+P\+Exception\+Catcher/\+O\+M\+P\+Exception\+Catcher.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Mappel/util.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Mappel/mcmc.\+h\char`\"{}}\\*
\subsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespacemappel}{mappel}
\item 
 \hyperlink{namespacemappel_1_1methods}{mappel\+::methods}
\begin{DoxyCompactList}\small\item\em Templated functions for operating on a \hyperlink{classmappel_1_1PointEmitterModel}{Point\+Emitter\+Model}. \end{DoxyCompactList}\item 
 \hyperlink{namespacemappel_1_1methods_1_1openmp}{mappel\+::methods\+::openmp}
\item 
 \hyperlink{namespacemappel_1_1methods_1_1objective}{mappel\+::methods\+::objective}
\item 
 \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp}{mappel\+::methods\+::objective\+::openmp}
\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_aecbee53826dbf135920ebe6532fb38cd}{mappel\+::methods\+::openmp\+::sample\+\_\+prior\+\_\+stack} (const Model \&model, Param\+VecT$<$ Model $>$ \&theta\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel sampling of the model prior. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a618f312f9e8b3a5d9972be5d755a7edb}{mappel\+::methods\+::openmp\+::model\+\_\+image\+\_\+stack} (const Model \&model, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, Image\+StackT$<$ Model $>$ \&image\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel computation of the model image. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a2db11e0e59544e0a4d3fc20a644c12ea}{mappel\+::methods\+::openmp\+::simulate\+\_\+image\+\_\+stack} (const Model \&model, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, Image\+StackT$<$ Model $>$ \&image\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel simulation of images from one or more theta. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_aba5970f5df4416a3d26c3ca5a86b8da5}{mappel\+::methods\+::openmp\+::cr\+\_\+lower\+\_\+bound\+\_\+stack} (const Model \&model, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, Param\+VecT$<$ Model $>$ \&crlb\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_ad58ad93952714ee5b5d7701cdf6032a8}{mappel\+::methods\+::openmp\+::expected\+\_\+information\+\_\+stack} (const Model \&model, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, CubeT \&fisher\+I\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a2bbaebf7c6b7b0ed3ee4f0f7402ffc4f}{mappel\+::methods\+::openmp\+::estimate\+\_\+max\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&data\+\_\+stack, const std\+::string \&method, estimator\+::\+M\+L\+E\+Data\+Stack \&mle\+\_\+data\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a0af63cdb807bd28497c32e3191e83181}{mappel\+::methods\+::openmp\+::estimate\+\_\+max\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&data\+\_\+stack, const std\+::string \&method, estimator\+::\+M\+L\+E\+Data\+Stack \&mle\+\_\+data\+\_\+stack, StatsT \&stats)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a70dc7b79d0b63bb604e670a7cd075c56}{mappel\+::methods\+::openmp\+::estimate\+\_\+max\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&data\+\_\+stack, const std\+::string \&method, Param\+VecT$<$ Model $>$ \&theta\+\_\+init\+\_\+stack, estimator\+::\+M\+L\+E\+Data\+Stack \&mle\+\_\+data\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a8e3af28b0599091dbcc1ee882ea36498}{mappel\+::methods\+::openmp\+::estimate\+\_\+max\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&data\+\_\+stack, const std\+::string \&method, Param\+VecT$<$ Model $>$ \&theta\+\_\+init\+\_\+stack, estimator\+::\+M\+L\+E\+Data\+Stack \&mle\+\_\+data\+\_\+stack, StatsT \&stats)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_adaca1fbf3ed4990eee89a7721cfa5666}{mappel\+::methods\+::openmp\+::estimate\+\_\+profile\+\_\+likelihood\+\_\+stack} (const Model \&model, const Model\+DataT$<$ Model $>$ \&data, const std\+::string \&method, const Param\+VecT$<$ Model $>$ \&fixed\+\_\+theta\+\_\+init, estimator\+::\+Profile\+Likelihood\+Data \&est)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a5e8898ef99b03faec55c9165b96ecb30}{mappel\+::methods\+::openmp\+::estimate\+\_\+profile\+\_\+likelihood\+\_\+stack} (const Model \&model, const Model\+DataT$<$ Model $>$ \&data, const std\+::string \&method, const Param\+VecT$<$ Model $>$ \&fixed\+\_\+theta\+\_\+init, estimator\+::\+Profile\+Likelihood\+Data \&est, StatsT \&stats)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_ae2fe47dafd5e1d2ca73fbc24ba34c4ff}{mappel\+::methods\+::openmp\+::estimate\+\_\+posterior\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&data\+\_\+stack, const Param\+VecT$<$ Model $>$ \&theta\+\_\+init\+\_\+stack, mcmc\+::\+M\+C\+M\+C\+Data\+Stack \&est)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a86a4ec8918ed62a8f0665a6fc1885ab9}{mappel\+::methods\+::openmp\+::estimate\+\_\+posterior\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&data\+\_\+stack, mcmc\+::\+M\+C\+M\+C\+Data\+Stack \&est)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_ac9aac4b2df768e850bee73aa5c7f2686}{mappel\+::methods\+::openmp\+::error\+\_\+bounds\+\_\+expected\+\_\+stack} (const Model \&model, const MatT \&theta\+\_\+est\+\_\+stack, double confidence, MatT \&theta\+\_\+lb\+\_\+stack, MatT \&theta\+\_\+ub\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a82a1f1d04ea0a21f003b35fad25a3442}{mappel\+::methods\+::openmp\+::error\+\_\+bounds\+\_\+observed\+\_\+stack} (const Model \&model, const MatT \&theta\+\_\+est\+\_\+stack, CubeT \&obs\+I\+\_\+stack, double confidence, MatT \&theta\+\_\+lb\+\_\+stack, MatT \&theta\+\_\+ub\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_ad79d4ade28ab7a6369e7215a6e317692}{mappel\+::methods\+::openmp\+::error\+\_\+bounds\+\_\+profile\+\_\+likelihood\+\_\+parallel} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&image, estimator\+::\+Profile\+Bounds\+Data \&est, StatsT \&stats)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a0fc866281e3dbe1810951b048485be95}{mappel\+::methods\+::openmp\+::error\+\_\+bounds\+\_\+profile\+\_\+likelihood\+\_\+parallel} (const Model \&model, const Model\+DataT$<$ Model $>$ \&image, estimator\+::\+Profile\+Bounds\+Data \&est)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_ab915be56d7945a80e2d72595c5c6cfb9}{mappel\+::methods\+::openmp\+::error\+\_\+bounds\+\_\+profile\+\_\+likelihood\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&image, estimator\+::\+Profile\+Bounds\+Data\+Stack \&est, StatsT \&stats)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1openmp_a6a5445ea593c9ad86480f82ecf1916b4}{mappel\+::methods\+::openmp\+::error\+\_\+bounds\+\_\+profile\+\_\+likelihood\+\_\+stack} (const Model \&model, const Model\+Data\+StackT$<$ Model $>$ \&image, estimator\+::\+Profile\+Bounds\+Data\+Stack \&est)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_ac3b3259220fa0dad56adb3db28711c55}{mappel\+::methods\+::objective\+::openmp\+::llh\+\_\+stack} (const Model \&model, const ImageT$<$ Model $>$ \&image, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, VecT \&llh\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel log\+\_\+likelihood calculations for a single image. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_aacd838da9a8dd9462fe970b4e3fae0f0}{mappel\+::methods\+::objective\+::openmp\+::llh\+\_\+stack} (const Model \&model, const Image\+StackT$<$ Model $>$ \&image\+\_\+stack, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, VecT \&llh\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel log\+\_\+likelihood calculations for a stack of images. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_a8223d746bf91530f8cff4ec168e50b1d}{mappel\+::methods\+::objective\+::openmp\+::rllh\+\_\+stack} (const Model \&model, const Image\+StackT$<$ Model $>$ \&image\+\_\+stack, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, VecT \&rllh\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel relative log\+\_\+likelihood calculations for a stack of images. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_afc8658d8593725d7de99dc533fa74274}{mappel\+::methods\+::objective\+::openmp\+::rllh\+\_\+stack} (const Model \&model, const ImageT$<$ Model $>$ \&image, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, VecT \&rllh\+\_\+stack)
\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_aab0aa1ca7dbd172a955148063a112f50}{mappel\+::methods\+::objective\+::openmp\+::grad\+\_\+stack} (const Model \&model, const Image\+StackT$<$ Model $>$ \&image\+\_\+stack, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, Param\+VecT$<$ Model $>$ \&grad\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel model gradient calculations for a stack of images. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_a134e673cbfdb9ac4e2d9ebec23ca2841}{mappel\+::methods\+::objective\+::openmp\+::hessian\+\_\+stack} (const Model \&model, const Image\+StackT$<$ Model $>$ \&image\+\_\+stack, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, CubeT \&hessian\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel model Hessian calculations for a stack of images. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Model $>$ }\\void \hyperlink{namespacemappel_1_1methods_1_1objective_1_1openmp_ad6a735087d0a6a785be32c3edaff6f1e}{mappel\+::methods\+::objective\+::openmp\+::negative\+\_\+definite\+\_\+hessian\+\_\+stack} (const Model \&model, const Image\+StackT$<$ Model $>$ \&image\+\_\+stack, const Param\+VecT$<$ Model $>$ \&theta\+\_\+stack, CubeT \&hessian\+\_\+stack)
\begin{DoxyCompactList}\small\item\em Parallel model negative\+\_\+definite Hessian approximation calculations for a stack of images. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
Namespaces for Open\+MP parallelized versions of the mappel\+::model namespace functions (external methods) 

\begin{DoxyAuthor}{Author}
Mark J. Olah (mjo@cs.\+unm D\+OT edu) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2013-\/2019 Open\+MP computation for stacked Model operations on vector data.
\end{DoxyDate}
Design Decisions
\begin{DoxyItemize}
\item Open\+MP vectorized versions are implemented as templated external methods in inline namespaces openmp. This allows easy future replacement with other palatalization mechanisms (C\+U\+DA, C++11 threads, etc..). Also allows the vectorized versions to directly overload with the non-\/vectorized base-\/versions.
\item Because we want to integrate as seamlessly as possible with matlab, we use the armadillo package which stores arrays in column major order.
\item Therefore in the $\ast$\+\_\+stack operations, if they are to be parallelized, we want the data stored as a n\+Parms X n matrix, i.\+e. each column is a parameter matrix. Similarly stacks are size X size X n, so that contiguous images sequences are contiguous in memory. This avoids false sharing. 
\end{DoxyItemize}